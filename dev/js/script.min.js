"use strict";

window.onload = function () {
  // MENU OPEN START
  var burger = document.querySelector('.hamburger');
  var menu = document.querySelector('.menu');
  burger.addEventListener('click', menuOpen);

  function menuOpen() {
    menu.classList.toggle('menu-open');
  }

  menu.addEventListener('click', menuClose);

  function menuClose(e) {
    var targetElem = e.target;
    var goalLink = targetElem.classList.contains('menu__link');

    if (goalLink) {
      targetElem.closest('nav.menu').classList.toggle('menu-open');
    }
  }

  document.addEventListener('click', function (e) {
    var targetElem = e.target;
    var goalLink1 = targetElem.classList.contains('hamburger');
    var goalLink2 = targetElem.classList.contains('hamburger__item');

    if (!goalLink1 && !goalLink2 && menu.classList.contains('menu-open')) {
      menu.classList.remove('menu-open');
    }
  }); // MENU OPEN END
  // PRICE OPEN START

  var workProduct = document.querySelectorAll('.workcost__product');
  workProduct.forEach(function (element) {
    element.addEventListener('click', function (e) {
      var target = e.target;
      var workInfo = element.querySelector('.workcost__info');

      if (target.classList.contains('workcost__title')) {
        element.classList.toggle('workcost__product-open');
        workInfo.classList.toggle('workcost__info-open');
      } else if (target.parentElement.classList.contains('workcost__title')) {
        element.classList.toggle('workcost__product-open');
        workInfo.classList.toggle('workcost__info-open');
      } else {
        return false;
      }
    });
  }); // PRICE OPEN END
  // CAROUSEL START

  var carousel = document.querySelector('.portfolio__carusel');
  var list = carousel.querySelector('.portfolio__slider');
  var listElems = carousel.querySelectorAll('.portfolio__item');
  var galleriBlock = carousel.querySelector('.portfolio__gallery');
  var btnPrev = carousel.querySelector('.portfolio__arrow-prev');
  var btnNext = carousel.querySelector('.portfolio__arrow-next');
  var btnLoad = document.querySelector('.portfolio__btn-load');
  var position = 0;
  var width = 347;
  var count;

  if (window.innerWidth > 1240) {
    count = 3;
  } else if (window.innerWidth <= 1240) {
    count = 2;
  }

  btnPrev.onclick = function () {
    if (window.innerWidth > 1240) {
      count = 3;
    } else if (window.innerWidth <= 1240) {
      count = 2;
    }

    position += width * count;

    if (position == 0) {
      this.setAttribute('disabled', 'disabled');
      btnNext.removeAttribute('disabled');
    } else {
      this.removeAttribute('disabled');
      btnNext.removeAttribute('disabled');
    }

    position = Math.min(position, 0);
    list.style.marginLeft = position + 'px';
  };

  btnNext.onclick = function () {
    if (window.innerWidth > 1240) {
      count = 3;
    } else if (window.innerWidth <= 1240) {
      count = 2;
    }

    position -= width * count;
    var disPoint = listElems.length * width;

    if (Math.abs(position) >= disPoint) {
      this.setAttribute('disabled', 'disabled');
      btnPrev.removeAttribute('disabled');
    } else {
      this.removeAttribute('disabled');
      btnPrev.removeAttribute('disabled');
    }

    position = Math.max(position, -width * (listElems.length - count));
    list.style.marginLeft = position + 'px';
  };

  btnLoad.onclick = function () {
    var arrClass = [];
    listElems.forEach(function (item, ind) {
      if (item.classList.contains('portfolio__item-open')) {
        arrClass.push(ind);
      }

      ;
    });

    if (arrClass.length < listElems.length) {
      var diffLength = listElems.length - arrClass.length;

      if (diffLength > 3) {
        for (var i = arrClass.length; i < arrClass.length + 3; i++) {
          listElems[i].classList.remove('portfolio__item-close');
          listElems[i].classList.add('portfolio__item-open');
        }
      } else {
        for (var _i = arrClass.length; _i < arrClass.length + diffLength; _i++) {
          listElems[_i].classList.remove('portfolio__item-close');

          listElems[_i].classList.add('portfolio__item-open');
        }
      }
    }
  }; // CAROUSEL END

};
"use strict";

// VALIDATION ORDER SERVICE
var formOrder = document.querySelector('#form');
var inputName = formOrder.elements.input_name;
var inputLink = formOrder.elements.input_link;
var inputEmail = formOrder.elements.input_email;
var btnOrder = formOrder.querySelector('button[type="submit"]');
var regexName = /^[A-zА-яЁё, \n]+$/;
var regexSite = /^[-a-z0-9+&@#\/%?=~_|!:,.;]\.*[-a-z0-9+&@#\/%?=~_|!:,.;]*\.[-a-z0-9+&@#\/%=~_|]/;
var regexMail = /@(?:[A-z0-9](?:[A-z0-9-]*[A-z0-9])?)/;

function valid(elem, target, reg) {
  var check = target.parentElement.querySelector('.icon-error');
  var succes = target.parentElement.querySelector('.icon-check');

  if (elem.value.match(reg) && elem.value.length > 0) {
    succes.style.visibility = 'visible';
    check.style.visibility = 'hidden';
  } else if (!elem.value.match(reg) && elem.value.length > 0) {
    succes.style.visibility = 'hidden';
    check.style.visibility = 'visible';
  } else {
    succes.style.visibility = 'hidden';
    check.style.visibility = 'hidden';
  }
}

function btnDisabled() {
  var iconCheck = formOrder.querySelectorAll('.icon-check');
  var arr = [];

  for (var i = 0; i < iconCheck.length; i++) {
    if (iconCheck[i].style.visibility == 'visible') {
      arr.push('1');
    }
  }

  if (arr.length >= 3) {
    btnOrder.removeAttribute('disabled');
  } else {
    btnOrder.setAttribute('disabled', 'disabled');
  }
}

inputName.oninput = function (event) {
  var target = event.target;
  valid(inputName, target, regexName);
  btnDisabled();
};

inputLink.oninput = function (event) {
  var target = event.target;
  valid(inputLink, target, regexSite);
  btnDisabled();
};

inputEmail.oninput = function (event) {
  var target = event.target;
  valid(inputEmail, target, regexMail);
  btnDisabled();
};
"use strict";

var yourId = '897078996';
/* токен бота */

var token = '1476474018:AAEE6lTN7EebIkistIy9rov4lDbcPLhMq1I';
var form = document.forms.mainForm;
form.addEventListener('submit', function (e) {
  e.preventDefault();
  var name = form.input_name.value;
  var link = form.input_link.value;
  var email = form.input_email.value;
  var tarif = form.input_tarif.value;

  function validateEmail(email, link) {
    if (email.indexOf('@') > -1) {
      if (link.indexOf('.') > -1) {
        return true;
      } else {
        return false;
      }
    } else {
      return false;
    }
  }

  if (validateEmail(email, link) === true) {
    var msg = "Имя:%20" + name + "%0A" + "Ссылка на сайт:%20" + link + "%0A" + "Тариф:%20" + tarif + "%0A" + "Почта/телеграм:%20" + email;
    var xhttp = new XMLHttpRequest();
    var url = "https://api.telegram.org/bot" + token + "/sendMessage?chat_id=" + yourId + "&text=";
    xhttp.open('GET', url + msg);
    xhttp.send();
    form.input_name.value = '';
    form.input_link.value = '';
    form.input_email.value = '';
    form.input_tarif.value = '';
    var push = document.querySelector('.push-block');
    var pushClose = document.querySelector('.push__close');
    var body = document.body;
    xhttp.addEventListener('readystatechange', function () {
      if (this.readyState === 4 && this.status === 200) {
        var checks = document.querySelectorAll('.icon-error');
        var success = document.querySelectorAll('.icon-check');
        checks.forEach(function (item) {
          return item.style.visibility = 'hidden';
        });
        success.forEach(function (item) {
          return item.style.visibility = 'hidden';
        });
        disableScroll();
        push.classList.add('push-block-active');
        setTimeout(function () {
          return push.style.opacity = 1;
        }, 500);
        setTimeout(function () {
          push.style.opacity = 0;
          setTimeout(function () {
            push.classList.remove('push-block-active');
            enableScroll();
          }, 500);
        }, 5000);
      }
    });
    pushClose.addEventListener('click', function () {
      push.style.opacity = 0;
      setTimeout(function () {
        push.classList.remove('push-block-active');
        enableScroll();
      }, 500);
    });

    function disableScroll() {
      var pagePosition = window.scrollY;
      body.classList.add('scroll-hidden');
      body.dataset.position = pagePosition;
    }

    function enableScroll() {
      var pagePosition = parseInt(body.dataset.position, 10);
      body.style.top = 'auto';
      body.classList.remove('scroll-hidden');
      window.scroll({
        top: pagePosition,
        left: 0
      });
      body.removeAttribute('data-position');
    }
  }
});